<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bharat English Academy - Ultimate Lab</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* --- THEME & COLORS --- */
        :root {
            --primary: #4f46e5;
            --secondary: #3b82f6;
            --accent: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #f8fafc;
            --glass: rgba(255, 255, 255, 0.95);
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
            color: #1e293b;
            margin: 0; padding: 0;
            padding-bottom: 100px;
        }

        /* HEADER */
        header {
            background: var(--glass);
            padding: 15px 20px;
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(10px);
        }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; display: flex; align-items: center; gap: 8px; }
        .xp-pill { background: var(--warning); color: #fff; padding: 5px 15px; border-radius: 20px; font-weight: bold; box-shadow: 0 2px 5px rgba(245, 158, 11, 0.4); }

        /* LAYOUT */
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 0 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .full-width { grid-column: 1 / -1; }

        /* WIDGETS */
        .widget {
            background: var(--glass);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.6);
            transition: transform 0.2s;
        }
        .widget:hover { transform: translateY(-3px); }
        
        h3 { margin-top: 0; color: var(--primary); display: flex; align-items: center; gap: 10px; font-size: 1.2rem; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }

        /* CONTROLS */
        input, textarea, select {
            width: 100%; padding: 12px;
            border: 2px solid #cbd5e1; border-radius: 10px;
            font-size: 1rem; margin-bottom: 10px;
            box-sizing: border-box; font-family: inherit;
            background: #f8fafc;
        }
        input:focus, textarea:focus { border-color: var(--primary); outline: none; background: #fff; }

        button {
            background: var(--primary); color: white; border: none;
            padding: 12px; border-radius: 10px; cursor: pointer;
            font-weight: 600; width: 100%; font-size: 1rem;
            transition: 0.2s; display: flex; justify-content: center; align-items: center; gap: 8px;
        }
        button:hover { background: #4338ca; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: #e0e7ff; }

        /* COUNTDOWN TIMER */
        .timer-box {
            background: var(--primary); color: white;
            text-align: center; padding: 20px; border-radius: 15px;
            margin-bottom: 20px;
        }
        .timer-digits { font-size: 2.5rem; font-weight: 800; letter-spacing: 2px; }

        /* GAME STYLES */
        .scramble-box { background: #fff7ed; border: 2px dashed #f97316; padding: 15px; text-align: center; border-radius: 12px; margin-bottom: 15px; }
        .scramble-text { font-size: 2rem; letter-spacing: 5px; color: #ea580c; font-weight: bold; }

        /* OUTPUT BOXES */
        .output {
            background: #fff; border-left: 5px solid var(--accent);
            padding: 20px; border-radius: 10px; margin-top: 15px;
            display: none; animation: slideIn 0.3s ease;
        }
        @keyframes slideIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

        /* NAV */
        .bottom-nav {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: #1e293b; padding: 12px 30px; border-radius: 50px;
            display: flex; gap: 30px; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        .bottom-nav a { color: #94a3b8; font-size: 1.5rem; transition: 0.2s; }
        .bottom-nav a:hover, .bottom-nav a.active { color: #fff; transform: scale(1.2); }
    </style>
</head>
<body>

    <header>
        <div class="logo"><i class="fa-solid fa-graduation-cap"></i> Bharat English</div>
        <div class="xp-pill">XP: <span id="xp-points">0</span></div>
    </header>

    <div class="container">

        <div class="widget full-width" style="background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%); color: white; border:none;">
            <div style="text-align: center;">
                <h2 style="margin:0; font-size:1.5rem;">üî• English Board Exam</h2>
                <p style="margin:5px 0 15px 0; opacity:0.9;">Time remaining for success!</p>
                <div class="timer-digits" id="countdown">00d 00h 00m</div>
            </div>
        </div>

        <div class="widget" id="game">
            <h3><i class="fa-solid fa-gamepad"></i> Spelling Game</h3>
            <div class="scramble-box">
                <div id="scramble-word" class="scramble-text">Loading...</div>
                <small id="scramble-hint" style="color:#c2410c;">(Hint: ...)</small>
            </div>
            <input type="text" id="user-guess" placeholder="Type correct spelling..." style="text-align:center; font-weight:bold;">
            <button onclick="checkSpelling()" style="background:#ea580c;">Check Answer</button>
            <div id="game-result" class="output" style="text-align:center;"></div>
        </div>

        <div class="widget">
            <h3><i class="fa-solid fa-lightbulb"></i> Idiom of the Day</h3>
            <div style="background:#f0fdf4; padding:20px; border-radius:12px; border:1px solid #bbf7d0;">
                <h2 style="margin:0; color:#15803d;">"Piece of Cake"</h2>
                <p style="color:#166534; font-weight:bold;">Meaning: Bahut Aasaan (Very Easy)</p>
                <p style="font-style:italic; color:#475569;">"The English exam was a piece of cake for me."</p>
            </div>
            <button class="btn-outline" style="margin-top:15px;">New Idiom</button>
        </div>

        <div class="widget full-width" id="dict">
            <h3><i class="fa-solid fa-language"></i> Smart Dictionary</h3>
            <div style="display:flex; gap:10px;">
                <input type="text" id="dict-input" placeholder="Type a word..." style="margin:0;">
                <button onclick="fetchMeaning()" style="width:auto;"><i class="fa-solid fa-search"></i></button>
            </div>
            <div id="dict-output" class="output">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2 id="word-title" style="margin:0; color:var(--primary);">...</h2>
                    <button onclick="playAudio()" style="width:auto; padding:5px 15px; border-radius:20px;"><i class="fa-solid fa-volume-high"></i></button>
                </div>
                <p id="hindi-word" style="font-size:1.2rem; color:#d946ef; font-weight:bold; margin:10px 0;">...</p>
                <div id="meanings-list"></div>
            </div>
        </div>

        <div class="widget" id="speaking">
            <h3><i class="fa-solid fa-microphone"></i> AI Speaking Coach</h3>
            <div style="background:#f1f5f9; padding:15px; border-radius:10px; text-align:center; margin-bottom:15px;">
                <h3 id="speak-target" style="margin:0; color:#334155; border:none; justify-content:center;">I want to learn English.</h3>
            </div>
            <div style="text-align:center;">
                <button onclick="startListening()" id="mic-btn" style="width:60px; height:60px; border-radius:50%; margin:0 auto;"><i class="fa-solid fa-microphone"></i></button>
                <p id="listening-status" style="font-size:0.8rem; margin-top:5px;">Tap Mic</p>
            </div>
            <div id="speak-result" class="output" style="text-align:center;"></div>
            <button class="btn-outline" onclick="nextSentence()" style="margin-top:10px;">Next Sentence</button>
        </div>

        <div class="widget">
            <h3><i class="fa-solid fa-clock"></i> Tense Master</h3>
            <select id="tense-verb" onchange="showTense()">
                <option value="go">Go (Jaana)</option>
                <option value="play">Play (Khelna)</option>
                <option value="eat">Eat (Khaana)</option>
                <option value="write">Write (Likhna)</option>
            </select>
            <div id="tense-output" class="output" style="display:none; padding:10px;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div style="background:#e0e7ff; padding:8px; border-radius:5px;"><small>Present</small><br><strong>Goes</strong></div>
                    <div style="background:#fee2e2; padding:8px; border-radius:5px;"><small>Past</small><br><strong>Went</strong></div>
                    <div style="background:#dcfce7; padding:8px; border-radius:5px;"><small>Future</small><br><strong>Will Go</strong></div>
                    <div style="background:#fef3c7; padding:8px; border-radius:5px;"><small>Cont.</small><br><strong>Is Going</strong></div>
                </div>
            </div>
        </div>

        <div class="widget full-width" id="essay">
            <h3><i class="fa-solid fa-scroll"></i> Essay Generator</h3>
            <div style="display:grid; grid-template-columns:2fr 1fr; gap:10px;">
                <input type="text" id="essay-topic" placeholder="Topic (e.g. Pollution)">
                <select id="essay-level"><option value="easy">Easy</option><option value="hard">Hard</option></select>
            </div>
            <button onclick="generateEssay()">Write Essay</button>
            <div id="essay-container" class="output">
                <div id="essay-content"></div>
                <button onclick="downloadPDF('essay-content', 'Essay.pdf')" class="btn-outline" style="margin-top:15px;"><i class="fa-solid fa-download"></i> Save PDF</button>
            </div>
        </div>

        <div class="widget full-width" id="letters">
            <h3><i class="fa-solid fa-envelope"></i> Letter Generator</h3>
            <input type="text" id="l-subject" placeholder="Subject">
            <textarea id="l-reason" rows="2" placeholder="Reason"></textarea>
            <button onclick="generateLetter()">Write Letter</button>
            <div id="letter-container" class="output">
                <div id="letter-content" style="font-family:'Courier New'; white-space:pre-wrap;"></div>
                <button onclick="downloadPDF('letter-content', 'Letter.pdf')" class="btn-outline" style="margin-top:15px;"><i class="fa-solid fa-download"></i> Save PDF</button>
            </div>
        </div>

    </div>

    <nav class="bottom-nav">
        <a href="#game" class="active"><i class="fa-solid fa-gamepad"></i></a>
        <a href="#dict"><i class="fa-solid fa-book"></i></a>
        <a href="#speaking"><i class="fa-solid fa-microphone"></i></a>
        <a href="#essay"><i class="fa-solid fa-file-lines"></i></a>
    </nav>

    <script>
        // --- GLOBAL XP ---
        let xp = 0;
        function addXP(n) { xp += n; document.getElementById('xp-points').innerText = xp; }

        // --- 1. COUNTDOWN LOGIC ---
        function updateTimer() {
            const examDate = new Date("March 15, 2026 09:00:00").getTime();
            const now = new Date().getTime();
            const diff = examDate - now;

            if (diff > 0) {
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                document.getElementById("countdown").innerText = `${d}d ${h}h Left`;
            } else {
                document.getElementById("countdown").innerText = "Best of Luck!";
            }
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // --- 2. GAME LOGIC ---
        const gameWords = [
            {w:"SCHOOL", h:"Place to study"}, {w:"TEACHER", h:"Who teaches us"}, {w:"FRIEND", h:"Playmate"}, 
            {w:"SUMMER", h:"Hot Season"}, {w:"ENGLISH", h:"Language"}
        ];
        let curGameWord = {};
        
        function loadGame() {
            const r = Math.floor(Math.random() * gameWords.length);
            curGameWord = gameWords[r];
            const scrambled = curGameWord.w.split('').sort(() => 0.5 - Math.random()).join(' ');
            document.getElementById('scramble-word').innerText = scrambled;
            document.getElementById('scramble-hint').innerText = `Hint: ${curGameWord.h}`;
            document.getElementById('user-guess').value = "";
            document.getElementById('game-result').style.display = "none";
        }
        
        function checkSpelling() {
            const g = document.getElementById('user-guess').value.toUpperCase().trim();
            const res = document.getElementById('game-result');
            res.style.display = "block";
            if(g === curGameWord.w) {
                res.innerHTML = "<h3 style='color:green; margin:0'>üéâ Correct! +10 XP</h3>";
                addXP(10); setTimeout(loadGame, 1500);
            } else {
                res.innerHTML = "<h3 style='color:red; margin:0'>‚ùå Try Again</h3>";
            }
        }
        loadGame();

        // --- 3. DICTIONARY ---
        let audioUrl = null;
        async function fetchMeaning() {
            const w = document.getElementById('dict-input').value;
            const out = document.getElementById('dict-output');
            if(!w) return;
            out.style.display="block"; 
            document.getElementById('word-title').innerText = w;
            document.getElementById('hindi-word').innerText = "Searching...";
            
            // Hindi
            try {
                const r1 = await fetch(`https://api.mymemory.translated.net/get?q=${w}&langpair=en|hi`);
                const d1 = await r1.json();
                document.getElementById('hindi-word').innerText = d1.responseData.translatedText;
            } catch(e) { document.getElementById('hindi-word').innerText = "Hindi not found"; }

            // English
            try {
                const r2 = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${w}`);
                const d2 = await r2.json();
                const aud = d2[0].phonetics.find(p => p.audio);
                audioUrl = aud ? aud.audio : null;
                document.getElementById('meanings-list').innerHTML = `<strong>${d2[0].meanings[0].partOfSpeech}:</strong> ${d2[0].meanings[0].definitions[0].definition}`;
                addXP(5);
            } catch(e) { document.getElementById('meanings-list').innerText = "Definition not found"; }
        }
        function playAudio() { if(audioUrl) new Audio(audioUrl).play(); }

        // --- 4. SPEAKING COACH ---
        const sList = ["I like reading books", "Education is important", "I live in India"];
        let sIdx = 0;
        function nextSentence() {
            sIdx = (sIdx+1)%sList.length;
            document.getElementById('speak-target').innerText = sList[sIdx];
            document.getElementById('speak-result').style.display="none";
        }
        function startListening() {
            if(!('webkitSpeechRecognition' in window)) { alert("Use Chrome Browser"); return; }
            const rec = new webkitSpeechRecognition();
            rec.lang = 'en-US';
            const btn = document.getElementById('mic-btn');
            
            rec.onstart = () => { btn.style.background="red"; document.getElementById('listening-status').innerText="Listening..."; };
            rec.onend = () => { btn.style.background="#4f46e5"; document.getElementById('listening-status').innerText="Tap Mic"; };
            rec.onresult = (e) => {
                const spoken = e.results[0][0].transcript.toLowerCase();
                const target = document.getElementById('speak-target').innerText.toLowerCase();
                const res = document.getElementById('speak-result');
                res.style.display="block";
                if(spoken.includes(target) || target.includes(spoken)) {
                    res.innerHTML = `<h4 style="color:green; margin:0">‚úÖ Great Job!</h4>`; addXP(20);
                } else {
                    res.innerHTML = `<h4 style="color:red; margin:0">‚ùå You said: "${spoken}"</h4>`;
                }
            };
            rec.start();
        }

        // --- 5. TENSE MASTER ---
        const verbs = {
            "go": ["Goes", "Went", "Will Go", "Is Going"],
            "play": ["Plays", "Played", "Will Play", "Is Playing"],
            "eat": ["Eats", "Ate", "Will Eat", "Is Eating"],
            "write": ["Writes", "Wrote", "Will Write", "Is Writing"]
        };
        function showTense() {
            const v = document.getElementById('tense-verb').value;
            const t = verbs[v];
            const boxes = document.querySelectorAll('#tense-output strong');
            boxes.forEach((b, i) => b.innerText = t[i]);
            document.getElementById('tense-output').style.display="block";
        }

        // --- 6. ESSAY & LETTER ---
        function generateEssay() {
            const t = document.getElementById('essay-topic').value || "Topic";
            const level = document.getElementById('essay-level').value;
            let txt = `${t} is a very important topic. It helps us understand the world better. Everyone should know about ${t}. It plays a big role in our society. We must use it wisely for a better future.`;
            if(level==='hard') txt = `${t} holds significant importance in contemporary society. It creates a profound impact on our daily lives. A deeper understanding of ${t} is essential for progress. We must advocate for its positive utilization to ensure sustainable development.`;
            
            document.getElementById('essay-container').style.display="block";
            document.getElementById('essay-content').innerHTML = `<h3>${t}</h3><p>${txt}</p>`;
            addXP(15);
        }

        function generateLetter() {
            const s = document.getElementById('l-subject').value;
            const r = document.getElementById('l-reason').value;
            const txt = `To,\nThe Principal,\n[School Name]\n\nSubject: ${s}\n\nRespected Sir/Madam,\n\nI beg to state that I am a student of Class 10. ${r}\n\nKindly grant me permission.\n\nYours Obediently,\nName: XYZ`;
            
            document.getElementById('letter-container').style.display="block";
            document.getElementById('letter-content').innerText = txt;
            addXP(15);
        }

        function downloadPDF(id, name) {
            const el = document.getElementById(id);
            html2pdf().from(el).save(name);
        }
        
        // --- NAV LOGIC ---
        document.querySelectorAll('.bottom-nav a').forEach(a => {
            a.addEventListener('click', function() {
                document.querySelectorAll('.bottom-nav a').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>
